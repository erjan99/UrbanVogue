{% extends 'mainPages/base.html' %}
{% load static %}

{% block content %}
<div class="container py-5" style="font-family: 'Montserrat', sans-serif;">
  <h2 class="mb-4 text-center">Your Shopping Cart</h2>

  {% if cart.orders.all %}
  <div class="row">
    {% for order in cart.orders.all %}
    <div class="col-12 col-lg-4 col-md-6 mb-4">
      <div class="card h-100 shadow-sm border-0 rounded-3 overflow-hidden hover-shadow" style="font-family: 'Montserrat', sans-serif;">
        <div class="position-relative">
          <a href="{% url 'detail_view' order.product.id %}">
            <img src="{{ order.product.main_image.url }}" class="card-img-top" alt="{{ order.product.name }}"
                 style="height: 260px; object-fit: cover; transition: transform 0.3s;">
          </a>
          <div class="position-absolute top-0 end-0 p-2">
            <a href="{% url 'cart_remove_product' order.id %}" class="text-decoration-none">
              <button class="btn btn-sm btn-outline-danger rounded-circle" title="Remove from cart">
                <i class="fa fa-trash"></i>
              </button>
            </a>
          </div>
        </div>

        <div class="card-body d-flex flex-column">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="badge bg-light text-dark">{{ order.product.brand.name }}</span>
            <span class="badge bg-light text-dark">{{ order.product.category.name }}</span>
          </div>

          <h5 class="card-title">
            <a href="{% url 'detail_view' order.product.id %}" class="text-decoration-none text-dark font-weight-bold" >{{ order.product.name }}</a>
          </h5>

          <p class="card-text text-muted small mb-3">
            {{ order.product.description|truncatechars:70 }}
          </p>

          <div class="mt-auto">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div>
                <span class="h5 fw-bold" style="background: linear-gradient(45deg, #2691ff, #0172ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${{ order.product.price }}</span>
                {% if order.product.gender %}
                <small class="text-muted ms-2">{{ order.product.get_gender_display }}</small>
                {% endif %}
              </div>
              <div>
                <div class="stars">
                  <i class="text-warning fa fa-star"></i>
                  <i class="text-warning fa fa-star"></i>
                  <i class="text-warning fa fa-star"></i>
                  <i class="text-warning fa fa-star"></i>
                  <i class="text-muted fa fa-star"></i>
                </div>
              </div>
            </div>

            <div class="border-top pt-3">
              <div class="d-flex justify-content-between mb-2">
                <span class="text-muted">Size:</span>
                <span class="fw-bold">{{ order.size.code }}</span>
              </div>

              <div class="d-flex justify-content-between mb-2">
                <span class="text-muted">Color:</span>
                <div>
                  <span class="fw-bold">{{ order.color.color }}</span>
                  <span class="color-dot ms-1" style="background-color: {{ order.color.color_code }}; display: inline-block; width: 12px; height: 12px; border-radius: 50%;"></span>
                </div>
              </div>

              <div class="d-flex justify-content-between mb-3">
                <span class="text-muted">Quantity:</span>
                <div class="d-flex align-items-center">
                  <button class="btn btn-sm btn-outline-secondary me-2">-</button>
                  <span class="fw-bold mx-2">{{ order.quantity }}</span>
                  <button class="btn btn-sm btn-outline-secondary ms-2">+</button>
                </div>
              </div>

              <div class="d-flex justify-content-between mb-2">
                <span class="text-muted">Subtotal:</span>
                <span class="fw-bold" style="background: linear-gradient(45deg, #2691ff, #0172ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${{ order.subtotal }}</span>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}

  </div>

  <div class="row mt-4">
    <div class="col-12">
      <div class="d-flex justify-content-between">
        <a href="{% url 'index_view' %}" class="btn btn-outline-secondary" style="border-radius: 8px;">
          <i class="fa fa-arrow-left me-2"></i>Continue Shopping
        </a>
        <a href="{% url 'checkout' %}" class="btn btn-primary" style="background: linear-gradient(45deg, #2691ff, #0172ff); border: none;">
          Proceed to Checkout(${{ total_price }})<i class="fa fa-arrow-right ms-2"></i>
        </a>
      </div>
    </div>
  </div>
  {% else %}
  <div class="col-12 text-center py-5">
    <div class="empty-cart">
      <i class="fa fa-shopping-cart fa-4x text-muted mb-3"></i>
      <h4 class="text-muted">Your cart is empty</h4>
      <p class="text-muted mb-4">Looks like you haven't added anything to your cart yet</p>
      <a href="{% url 'index_view' %}" class="btn btn-primary" style="background: linear-gradient(45deg, #2691ff, #0172ff); border: none;">Start Shopping</a>
    </div>
  </div>
  {% endif %}
</div>

<style>
  .hover-shadow:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
    transition: all 0.3s ease;
  }

  .hover-shadow:hover img {
    transform: scale(1.03);
  }

  .card-title {
    font-weight: 600;
    font-family: 'Montserrat', sans-serif;
  }

  .card {
    transition: all 0.3s ease;
    font-family: 'Montserrat', sans-serif;
  }

  .empty-cart {
    padding: 40px 0;
    font-family: 'Montserrat', sans-serif;
  }

  .cart-price-number {
    background: linear-gradient(45deg, #2691ff, #0172ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: bold;
  }
</style>
{% endblock %}